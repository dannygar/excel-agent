{
  "$schema": "https://developer.microsoft.com/json-schemas/copilot/plugin/v2.4/schema.json",
  "schema_version": "v2.4",
  "name_for_human": "Excel Agent",
  "description_for_human": "Excel actions in agent",
  "namespace": "addInFunction",
  "functions": [
    {
      "name": "FillColor",
      "description": "FillColor changes a single cell location to a specific color.",
      "parameters": {
        "type": "object",
        "properties": {
          "Cell": {
            "type": "string",
            "description": "A cell location in the format of A1, B2, etc.",
            "default": "B2"
          },
          "Color": {
            "type": "string",
            "description": "A color in hex format, e.g., #30d5c8",
            "default": "#30d5c8"
          }
        },
        "required": [
          "Cell",
          "Color"
        ]
      },
      "returns": {
        "type": "string",
        "description": "A string indicating the result of the action."
      },
      "states": {
        "reasoning": {
          "description": "`FillColor` changes the color of a single cell based on the grid location and a color value.",
          "instructions": "The user will pass ask for a color that isn't in the hex format needed in most cases, make sure to convert to the closest approximation in the right format."
        },
        "responding": {
          "description": "`FillColor` changes the color of a single cell based on the grid location and a color value.",
          "instructions": "If there is no error present, tell the user the cell location and color that was set."
        }
      }
    },
    {
      "name": "EnterValue",
      "description": "EnterValue updates a single cell location with a specific value.",
      "parameters": {
        "type": "object",
        "properties": {
          "Cell": {
            "type": "string",
            "description": "A cell location in the format of A1, B2, etc.",
            "default": "A1"
          },
          "Value": {
            "type": "string",
            "description": "The value to enter in the cell (text, number, or formula)",
            "default": "Hello"
          }
        },
        "required": [
          "Cell",
          "Value"
        ]
      },
      "returns": {
        "type": "string",
        "description": "A string indicating the result of the action."
      },
      "states": {
        "reasoning": {
          "description": "`EnterValue` updates the value of a single cell based on the grid location.",
          "instructions": "Accept any text, number, or formula as the value. For formulas, ensure they start with an equals sign (=)."
        },
        "responding": {
          "description": "`EnterValue` updates the value of a single cell based on the grid location.",
          "instructions": "If there is no error present, tell the user the cell location and value that was set."
        }
      }
    },
    {
      "name": "CreateTable",
      "description": "Creates a formatted table in Excel with the provided column headers and data rows. The table will be inserted starting at a specified cell location.",
      "parameters": {
        "type": "object",
        "properties": {
          "StartCell": {
            "type": "string",
            "description": "The top-left cell location where the table should start (e.g., 'A1', 'B5')",
            "default": "A1"
          },
          "Headers": {
            "type": "string",
            "description": "Comma-separated list of column header names (e.g., 'Name,Age,City' or 'Product,Price,Quantity')"
          },
          "Rows": {
            "type": "string",
            "description": "Pipe-separated rows where each row contains comma-separated values matching the headers (e.g., 'John,25,NYC|Jane,30,LA|Bob,35,SF')"
          }
        },
        "required": [
          "StartCell",
          "Headers",
          "Rows"
        ]
      },
      "returns": {
        "type": "string",
        "description": "A string indicating the result of the table creation, including the range where the table was created."
      },
      "states": {
        "reasoning": {
          "description": "`CreateTable` creates a formatted table in Excel with headers and data rows at the specified location.",
          "instructions": "Parse the user's request to extract the starting cell, column headers, and row data. Ensure the number of values in each row matches the number of headers. If the user provides data in a different format, convert it to the required array structure."
        },
        "responding": {
          "description": "`CreateTable` creates a formatted table in Excel with headers and data rows.",
          "instructions": "If there is no error, tell the user the table was successfully created, mentioning the starting cell and the number of rows and columns. If there's a mismatch in data structure, explain what went wrong."
        }
      }
    },
    {
      "name": "get_company_revenue",
      "description": "Get total revenue in USD millions for a given company's quarterly earnings report",
      "parameters": {
        "type": "object",
        "properties": {
          "company_symbol": {
            "type": "string",
            "description": "The stock symbol of the company (e.g., MSFT, TSLA, NVDA).",
            "default": "MSFT"
          },
          "fiscal_year": {
            "type": "string",
            "description": "The fiscal year for the earnings report (e.g., 2024, 2025).",
            "default": "2025"
          },
          "fiscal_quarter": {
            "type": "string",
            "description": "The fiscal quarter for the earnings report (e.g., 1, 2, 3, 4).",
            "default": "Q1"
          }
        },
        "required": [
          "company_symbol",
          "fiscal_year",
          "fiscal_quarter"
        ]
      },
      "returns": {
        "type": "string",
        "description": "The total revenue in USD millions for the specified company's quarterly earnings report."
      },
      "states": {
        "reasoning": {
          "description": "`get_company_revenue` retrieves the total revenue in USD millions for a given company's quarterly earnings report.",
          "instructions": "Use the provided company symbol, fiscal year, and fiscal quarter to search for the relevant earnings report. If the user provides the fiscal quarter in a different format (e.g., 'Q1' instead of '1'), convert it to the required format."
        },
        "responding": {
          "description": "`get_company_revenue` retrieves the total revenue in USD millions for a given company's quarterly earnings report.",
          "instructions": "If the revenue is successfully retrieved, provide the total revenue in USD millions. If there's an error (e.g., data not found), inform the user and suggest checking the provided parameters or contacting support."
        }
      }
    },
    {
      "name": "get_company_free_cash_flow",
      "description": "Get total free cash flow in USD millions for a given company's quarterly earnings report",
      "parameters": {
        "type": "object",
        "properties": {
          "company_symbol": {
            "type": "string",
            "description": "The stock symbol of the company (e.g., MSFT, TSLA, NVDA).",
            "default": "MSFT"
          },
          "fiscal_year": {
            "type": "string",
            "description": "The fiscal year for the earnings report (e.g., 2024, 2025).",
            "default": "2025"
          },
          "fiscal_quarter": {
            "type": "string",
            "description": "The fiscal quarter for the earnings report (e.g., 1, 2, 3, 4).",
            "default": "Q1"
          }
        },
        "required": [
          "company_symbol",
          "fiscal_year",
          "fiscal_quarter"
        ]
      },
      "returns": {
        "type": "string",
        "description": "The total free cash flow in USD millions for the specified company's quarterly earnings report."
      },
      "states": {
        "reasoning": {
          "description": "`get_company_free_cash_flow` retrieves the total free cash flow in USD millions for a given company's quarterly earnings report.",
          "instructions": "Use the provided company symbol, fiscal year, and fiscal quarter to search for the relevant earnings report. If the user provides the fiscal quarter in a different format (e.g., 'Q1' instead of '1'), convert it to the required format."
        },
        "responding": {
          "description": "`get_company_free_cash_flow` retrieves the total free cash flow in USD millions for a given company's quarterly earnings report.",
          "instructions": "If the free cash flow is successfully retrieved, provide the total free cash flow in USD millions. If there's an error (e.g., data not found), inform the user and suggest checking the provided parameters or contacting support."
        }
      }
    }
  ],
  "runtimes": [
    {
      "type": "LocalPlugin",
      "spec": {
        "local_endpoint": "Microsoft.Office.Addin"
      },
      "run_for_functions": [
        "FillColor",
        "EnterValue",
        "CreateTable"
      ]
    },
    {
      "type": "RemoteMCPServer",
      "spec": {
        "url": "https://func-api-lbb7y7o3kqtza.azurewebsites.net/runtime/webhooks/mcp/sse?code=<${mcp-extension-system-key}>"
      },
      "auth": {
        "type": "None"
      },
      "run_for_functions": [
        "get_company_revenue",
        "get_company_free_cash_flow"
      ]
    }
  ]
}