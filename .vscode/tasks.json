// This file is automatically generated by Microsoft 365 Agents Toolkit.
// The teamsfx tasks defined in this file require Microsoft 365 Agents Toolkit version >= 5.0.0.
// See https://aka.ms/teamsfx-tasks for details on how to customize each task.
{
    "version": "2.0.0",
    "tasks": [
        {
            "label": "Start Agent Locally",
            "dependsOn": [
                "Validate prerequisites",
                "Create resources"
            ],
            "dependsOrder": "sequence"
        },
        {
            "label": "Validate prerequisites",
            "type": "teamsfx",
            "command": "debug-check-prerequisites",
            "args": {
                "prerequisites": [
                    "m365Account"
                ]
            }
        },
        {
            "label": "Create resources",
            "type": "teamsfx",
            "command": "provision",
            "args": {
                "env": "local"
            }
        },
        {
            "label": "Start Agent Remotely",
            "dependsOn": [
                "Validate prerequisites",
                "Start Dev Tunnel",
                "Create resources",
                "Dev Server"
            ],
            "dependsOrder": "sequence"
        },
        {
            "label": "Start Dev Tunnel",
            "type": "shell",
            "command": "yarn tunnel:host",
            "isBackground": true,
            "presentation": {
                "reveal": "always",
                "panel": "dedicated"
            },
            "problemMatcher": {
                "pattern": {
                    "regexp": "^.*$"
                },
                "background": {
                    "activeOnStart": true,
                    "beginsPattern": ".*",
                    "endsPattern": "Ready to accept connections"
                }
            }
        },
    {
      "label": "Build (Development)",
      "type": "shell",
      "command": "yarn build:dev",
      "group": {
        "kind": "build",
        "isDefault": true
      },
      "presentation": {
        "clear": true,
        "panel": "shared",
        "showReuseMessage": false
      },
      "dependsOn": [
        "Install"
      ]
    },
    {
      "label": "Build (Production)",
      "type": "shell",
      "command": "yarn build",
      "group": "build",
      "presentation": {
        "clear": true,
        "panel": "shared",
        "showReuseMessage": false
      },
      "dependsOn": [
        "Install"
      ]
    },
    {
      "label": "Debug: Excel Desktop",
      "type": "shell",
      "command": "yarn start:desktop:excel",
      "presentation": {
        "clear": true,
        "panel": "dedicated"
      },
      "problemMatcher": [],
      "dependsOn": [
        "Install"
      ]
    },
    {
      "label": "Debug: Outlook Desktop",
      "type": "shell",
      "command": "yarn start:desktop:outlook",
      "presentation": {
        "clear": true,
        "panel": "dedicated"
      },
      "problemMatcher": [],
      "dependsOn": [
        "Install"
      ]
    },
    {
      "label": "Debug: PowerPoint Desktop",
      "type": "shell",
      "command": "yarn start:desktop:powerpoint",
      "presentation": {
        "clear": true,
        "panel": "dedicated"
      },
      "problemMatcher": [],
      "dependsOn": [
        "Install"
      ]
    },
    {
      "label": "Debug: Word Desktop",
      "type": "shell",
      "command": "yarn start:desktop:word",
      "presentation": {
        "clear": true,
        "panel": "dedicated"
      },
      "problemMatcher": [],
      "dependsOn": [
        "Install"
      ]
    },
    {
      "label": "Dev Server",
      "type": "shell",
      "command": "yarn dev-server",
      "presentation": {
        "clear": true,
        "panel": "dedicated"
      },
      "problemMatcher": []
    },
    {
      "label": "Install",
      "type": "shell",
      "command": "yarn install",
      "presentation": {
        "clear": true,
        "panel": "shared",
        "showReuseMessage": false
      },
      "problemMatcher": []
    },
    {
      "label": "Lint: Check for problems",
      "type": "shell",
      "command": "yarn lint",
      "problemMatcher": [
        "$eslint-stylish"
      ]
    },
    {
      "label": "Lint: Fix all auto-fixable problems",
      "type": "shell",
      "command": "yarn lint:fix",
      "problemMatcher": [
        "$eslint-stylish"
      ]
    },
    {
      "label": "Stop Debug",
      "type": "shell",
      "command": "yarn stop",
      "presentation": {
        "clear": true,
        "panel": "shared",
        "showReuseMessage": false
      },
      "problemMatcher": []
    },
    {
      "label": "Watch",
      "type": "shell",
      "command": "yarn watch",
      "presentation": {
        "clear": true,
        "panel": "dedicated"
      },
      "problemMatcher": []
    }
  ]
}